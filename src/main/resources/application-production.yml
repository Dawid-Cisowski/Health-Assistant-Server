# Production profile (Google Cloud Run + Cloud SQL)
spring:
  datasource:
    # Cloud SQL connection via socket factory
    # Format: jdbc:postgresql:///<DB_NAME>?cloudSqlInstance=<CONNECTION_NAME>&socketFactory=com.google.cloud.sql.postgres.SocketFactory
    url: ${SPRING_DATASOURCE_URL}
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}
    hikari:
      maximum-pool-size: ${SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE:10}
      minimum-idle: ${SPRING_DATASOURCE_HIKARI_MINIMUM_IDLE:5}
      connection-timeout: 45000
      idle-timeout: 300000
      max-lifetime: 1800000
      keepalive-time: 60000

  jpa:
    hibernate:
      ddl-auto: ${SPRING_JPA_HIBERNATE_DDL_AUTO:none}
    show-sql: false

logging:
  level:
    root: INFO
    com.healthassistant: INFO
    org.springframework.web: WARN
    org.hibernate.SQL: WARN

# OTLP metrics for Cloud Run sidecar
management:
  otlp:
    metrics:
      export:
        enabled: true
        url: http://localhost:4318/v1/metrics
        step: 1m
        resourceAttributes:
          service.name: health-assistant-server
          service.version: 1.0.0
          deployment.environment: production
          cloud.platform: gcp_cloud_run
          cloud.region: ${CLOUD_RUN_REGION:europe-central2}

